{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Wailer\\\\Downloads\\\\luct_reporting_app_\\\\luct_reporting_app\\\\frontend\\\\src\\\\utils\\\\auth.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [token, setToken] = useState(() => localStorage.getItem('token') || null);\n  const [user, setUser] = useState(() => {\n    const storedUser = localStorage.getItem('user');\n    return storedUser ? JSON.parse(storedUser) : null;\n  });\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    // Check if token is valid on app start\n    const checkAuth = async () => {\n      if (token) {\n        try {\n          // Verify token is still valid\n          const tokenData = JSON.parse(atob(token.split('.')[1]));\n          if (tokenData.exp * 1000 < Date.now()) {\n            console.log('Token expired, logging out...');\n            logout();\n          }\n        } catch (error) {\n          console.log('Invalid token, logging out...');\n          logout();\n        }\n      }\n      setLoading(false);\n    };\n    checkAuth();\n  }, []);\n  const saveLogin = (newToken, userObj) => {\n    console.log('Saving login:', {\n      newToken,\n      userObj\n    });\n    localStorage.setItem('token', newToken);\n    localStorage.setItem('user', JSON.stringify(userObj));\n    setToken(newToken);\n    setUser(userObj);\n  };\n  const logout = () => {\n    console.log('Logging out...');\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    setToken(null);\n    setUser(null);\n  };\n  const value = {\n    token,\n    user,\n    loading,\n    saveLogin,\n    logout,\n    isAuthenticated: !!token,\n    isLecturer: (user === null || user === void 0 ? void 0 : user.role) === 'Lecturer',\n    isAdmin: (user === null || user === void 0 ? void 0 : user.role) === 'Admin' || (user === null || user === void 0 ? void 0 : user.role) === 'PRL' || (user === null || user === void 0 ? void 0 : user.role) === 'PL'\n  };\n  console.log('Auth Context Value:', value);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"DhBuGcJEgjPoyepnCeGWkXmeuYs=\");\n_c = AuthProvider;\nexport function useAuth() {\n  _s2();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n_s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","token","setToken","localStorage","getItem","user","setUser","storedUser","JSON","parse","loading","setLoading","checkAuth","tokenData","atob","split","exp","Date","now","console","log","logout","error","saveLogin","newToken","userObj","setItem","stringify","removeItem","value","isAuthenticated","isLecturer","role","isAdmin","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","context","Error","$RefreshReg$"],"sources":["C:/Users/Wailer/Downloads/luct_reporting_app_/luct_reporting_app/frontend/src/utils/auth.jsx"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\n\nconst AuthContext = createContext();\n\nexport function AuthProvider({ children }) {\n  const [token, setToken] = useState(() => localStorage.getItem('token') || null);\n  const [user, setUser] = useState(() => {\n    const storedUser = localStorage.getItem('user');\n    return storedUser ? JSON.parse(storedUser) : null;\n  });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // Check if token is valid on app start\n    const checkAuth = async () => {\n      if (token) {\n        try {\n          // Verify token is still valid\n          const tokenData = JSON.parse(atob(token.split('.')[1]));\n          if (tokenData.exp * 1000 < Date.now()) {\n            console.log('Token expired, logging out...');\n            logout();\n          }\n        } catch (error) {\n          console.log('Invalid token, logging out...');\n          logout();\n        }\n      }\n      setLoading(false);\n    };\n\n    checkAuth();\n  }, []);\n\n  const saveLogin = (newToken, userObj) => {\n    console.log('Saving login:', { newToken, userObj });\n    localStorage.setItem('token', newToken);\n    localStorage.setItem('user', JSON.stringify(userObj));\n    setToken(newToken);\n    setUser(userObj);\n  };\n\n  const logout = () => {\n    console.log('Logging out...');\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    setToken(null);\n    setUser(null);\n  };\n\n  const value = {\n    token,\n    user,\n    loading,\n    saveLogin,\n    logout,\n    isAuthenticated: !!token,\n    isLecturer: user?.role === 'Lecturer',\n    isAdmin: user?.role === 'Admin' || user?.role === 'PRL' || user?.role === 'PL'\n  };\n\n  console.log('Auth Context Value:', value);\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}