{"ast":null,"code":"import axios from \"axios\";\n\n// Base API URL (from frontend .env)\nconst API_BASE_URL = process.env.REACT_APP_API_URL ? `${process.env.REACT_APP_API_URL}/api` : \"http://localhost:5000/api\";\nexport const API_ENDPOINTS = {\n  // Auth\n  REGISTER: `${API_BASE_URL}/auth/register`,\n  LOGIN: `${API_BASE_URL}/auth/login`,\n  ME: `${API_BASE_URL}/auth/me`,\n  // Data\n  FACULTIES: `${API_BASE_URL}/faculties`,\n  COURSES: `${API_BASE_URL}/courses`,\n  CLASSES: `${API_BASE_URL}/classes`,\n  MY_CLASSES: `${API_BASE_URL}/my-classes`,\n  // Reports\n  REPORTS: `${API_BASE_URL}/reports`,\n  REPORTS_STATS: `${API_BASE_URL}/reports/stats`,\n  // Health\n  HEALTH: `${API_BASE_URL}/health`\n};\n\n// Get token from localStorage\nexport const getAuthToken = () => {\n  return localStorage.getItem(\"token\");\n};\n\n// Enhanced API call wrapper with error handling and automatic auth\nexport const apiCall = async (endpoint, options = {}, requireAuth = false) => {\n  try {\n    const config = {\n      url: endpoint,\n      ...options\n    };\n\n    // Add auth headers if required\n    if (requireAuth) {\n      const token = getAuthToken();\n      if (!token) {\n        throw new Error(\"Authentication required: No token found\");\n      }\n      config.headers = {\n        ...config.headers,\n        Authorization: `Bearer ${token}`,\n        \"Content-Type\": \"application/json\"\n      };\n    }\n    const response = await axios(config);\n\n    // Handle backend response format\n    if (response.data && response.data.success === false) {\n      throw new Error(response.data.message || \"Request failed\");\n    }\n    return response.data;\n  } catch (error) {\n    var _error$response, _error$response2, _error$response3;\n    console.error(\"API Call failed:\", ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message);\n\n    // Handle specific error cases\n    if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 401) {\n      // Clear invalid token\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"user\");\n      // Redirect to login\n      window.location.href = \"/login\";\n    }\n    throw ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) || error;\n  }\n};\n\n// Convenience methods for common HTTP operations\nexport const api = {\n  get: (endpoint, requireAuth = false) => apiCall(endpoint, {\n    method: \"GET\"\n  }, requireAuth),\n  post: (endpoint, data, requireAuth = false) => apiCall(endpoint, {\n    method: \"POST\",\n    data\n  }, requireAuth),\n  put: (endpoint, data, requireAuth = false) => apiCall(endpoint, {\n    method: \"PUT\",\n    data\n  }, requireAuth),\n  delete: (endpoint, requireAuth = false) => apiCall(endpoint, {\n    method: \"DELETE\"\n  }, requireAuth)\n};","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","API_ENDPOINTS","REGISTER","LOGIN","ME","FACULTIES","COURSES","CLASSES","MY_CLASSES","REPORTS","REPORTS_STATS","HEALTH","getAuthToken","localStorage","getItem","apiCall","endpoint","options","requireAuth","config","url","token","Error","headers","Authorization","response","data","success","message","error","_error$response","_error$response2","_error$response3","console","status","removeItem","window","location","href","api","get","method","post","put","delete"],"sources":["C:/Users/Wailer/Downloads/luct_reporting_app_/luct_reporting_app/frontend/src/utils/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\n// Base API URL (from frontend .env)\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL\r\n  ? `${process.env.REACT_APP_API_URL}/api`\r\n  : \"http://localhost:5000/api\";\r\n\r\nexport const API_ENDPOINTS = {\r\n  // Auth\r\n  REGISTER: `${API_BASE_URL}/auth/register`,\r\n  LOGIN: `${API_BASE_URL}/auth/login`,\r\n  ME: `${API_BASE_URL}/auth/me`,\r\n\r\n  // Data\r\n  FACULTIES: `${API_BASE_URL}/faculties`,\r\n  COURSES: `${API_BASE_URL}/courses`,\r\n  CLASSES: `${API_BASE_URL}/classes`,\r\n  MY_CLASSES: `${API_BASE_URL}/my-classes`,\r\n\r\n  // Reports\r\n  REPORTS: `${API_BASE_URL}/reports`,\r\n  REPORTS_STATS: `${API_BASE_URL}/reports/stats`,\r\n\r\n  // Health\r\n  HEALTH: `${API_BASE_URL}/health`,\r\n};\r\n\r\n// Get token from localStorage\r\nexport const getAuthToken = () => {\r\n  return localStorage.getItem(\"token\");\r\n};\r\n\r\n// Enhanced API call wrapper with error handling and automatic auth\r\nexport const apiCall = async (endpoint, options = {}, requireAuth = false) => {\r\n  try {\r\n    const config = {\r\n      url: endpoint,\r\n      ...options,\r\n    };\r\n\r\n    // Add auth headers if required\r\n    if (requireAuth) {\r\n      const token = getAuthToken();\r\n      if (!token) {\r\n        throw new Error(\"Authentication required: No token found\");\r\n      }\r\n      config.headers = {\r\n        ...config.headers,\r\n        Authorization: `Bearer ${token}`,\r\n        \"Content-Type\": \"application/json\",\r\n      };\r\n    }\r\n\r\n    const response = await axios(config);\r\n    \r\n    // Handle backend response format\r\n    if (response.data && response.data.success === false) {\r\n      throw new Error(response.data.message || \"Request failed\");\r\n    }\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"API Call failed:\", error.response?.data || error.message);\r\n    \r\n    // Handle specific error cases\r\n    if (error.response?.status === 401) {\r\n      // Clear invalid token\r\n      localStorage.removeItem(\"token\");\r\n      localStorage.removeItem(\"user\");\r\n      // Redirect to login\r\n      window.location.href = \"/login\";\r\n    }\r\n    \r\n    throw error.response?.data || error;\r\n  }\r\n};\r\n\r\n// Convenience methods for common HTTP operations\r\nexport const api = {\r\n  get: (endpoint, requireAuth = false) => \r\n    apiCall(endpoint, { method: \"GET\" }, requireAuth),\r\n  \r\n  post: (endpoint, data, requireAuth = false) => \r\n    apiCall(endpoint, { method: \"POST\", data }, requireAuth),\r\n  \r\n  put: (endpoint, data, requireAuth = false) => \r\n    apiCall(endpoint, { method: \"PUT\", data }, requireAuth),\r\n  \r\n  delete: (endpoint, requireAuth = false) => \r\n    apiCall(endpoint, { method: \"DELETE\" }, requireAuth),\r\n};"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACA,MAAMC,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,GAC9C,GAAGF,OAAO,CAACC,GAAG,CAACC,iBAAiB,MAAM,GACtC,2BAA2B;AAE/B,OAAO,MAAMC,aAAa,GAAG;EAC3B;EACAC,QAAQ,EAAE,GAAGL,YAAY,gBAAgB;EACzCM,KAAK,EAAE,GAAGN,YAAY,aAAa;EACnCO,EAAE,EAAE,GAAGP,YAAY,UAAU;EAE7B;EACAQ,SAAS,EAAE,GAAGR,YAAY,YAAY;EACtCS,OAAO,EAAE,GAAGT,YAAY,UAAU;EAClCU,OAAO,EAAE,GAAGV,YAAY,UAAU;EAClCW,UAAU,EAAE,GAAGX,YAAY,aAAa;EAExC;EACAY,OAAO,EAAE,GAAGZ,YAAY,UAAU;EAClCa,aAAa,EAAE,GAAGb,YAAY,gBAAgB;EAE9C;EACAc,MAAM,EAAE,GAAGd,YAAY;AACzB,CAAC;;AAED;AACA,OAAO,MAAMe,YAAY,GAAGA,CAAA,KAAM;EAChC,OAAOC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AACtC,CAAC;;AAED;AACA,OAAO,MAAMC,OAAO,GAAG,MAAAA,CAAOC,QAAQ,EAAEC,OAAO,GAAG,CAAC,CAAC,EAAEC,WAAW,GAAG,KAAK,KAAK;EAC5E,IAAI;IACF,MAAMC,MAAM,GAAG;MACbC,GAAG,EAAEJ,QAAQ;MACb,GAAGC;IACL,CAAC;;IAED;IACA,IAAIC,WAAW,EAAE;MACf,MAAMG,KAAK,GAAGT,YAAY,CAAC,CAAC;MAC5B,IAAI,CAACS,KAAK,EAAE;QACV,MAAM,IAAIC,KAAK,CAAC,yCAAyC,CAAC;MAC5D;MACAH,MAAM,CAACI,OAAO,GAAG;QACf,GAAGJ,MAAM,CAACI,OAAO;QACjBC,aAAa,EAAE,UAAUH,KAAK,EAAE;QAChC,cAAc,EAAE;MAClB,CAAC;IACH;IAEA,MAAMI,QAAQ,GAAG,MAAM7B,KAAK,CAACuB,MAAM,CAAC;;IAEpC;IACA,IAAIM,QAAQ,CAACC,IAAI,IAAID,QAAQ,CAACC,IAAI,CAACC,OAAO,KAAK,KAAK,EAAE;MACpD,MAAM,IAAIL,KAAK,CAACG,QAAQ,CAACC,IAAI,CAACE,OAAO,IAAI,gBAAgB,CAAC;IAC5D;IAEA,OAAOH,QAAQ,CAACC,IAAI;EACtB,CAAC,CAAC,OAAOG,KAAK,EAAE;IAAA,IAAAC,eAAA,EAAAC,gBAAA,EAAAC,gBAAA;IACdC,OAAO,CAACJ,KAAK,CAAC,kBAAkB,EAAE,EAAAC,eAAA,GAAAD,KAAK,CAACJ,QAAQ,cAAAK,eAAA,uBAAdA,eAAA,CAAgBJ,IAAI,KAAIG,KAAK,CAACD,OAAO,CAAC;;IAExE;IACA,IAAI,EAAAG,gBAAA,GAAAF,KAAK,CAACJ,QAAQ,cAAAM,gBAAA,uBAAdA,gBAAA,CAAgBG,MAAM,MAAK,GAAG,EAAE;MAClC;MACArB,YAAY,CAACsB,UAAU,CAAC,OAAO,CAAC;MAChCtB,YAAY,CAACsB,UAAU,CAAC,MAAM,CAAC;MAC/B;MACAC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;IACjC;IAEA,MAAM,EAAAN,gBAAA,GAAAH,KAAK,CAACJ,QAAQ,cAAAO,gBAAA,uBAAdA,gBAAA,CAAgBN,IAAI,KAAIG,KAAK;EACrC;AACF,CAAC;;AAED;AACA,OAAO,MAAMU,GAAG,GAAG;EACjBC,GAAG,EAAEA,CAACxB,QAAQ,EAAEE,WAAW,GAAG,KAAK,KACjCH,OAAO,CAACC,QAAQ,EAAE;IAAEyB,MAAM,EAAE;EAAM,CAAC,EAAEvB,WAAW,CAAC;EAEnDwB,IAAI,EAAEA,CAAC1B,QAAQ,EAAEU,IAAI,EAAER,WAAW,GAAG,KAAK,KACxCH,OAAO,CAACC,QAAQ,EAAE;IAAEyB,MAAM,EAAE,MAAM;IAAEf;EAAK,CAAC,EAAER,WAAW,CAAC;EAE1DyB,GAAG,EAAEA,CAAC3B,QAAQ,EAAEU,IAAI,EAAER,WAAW,GAAG,KAAK,KACvCH,OAAO,CAACC,QAAQ,EAAE;IAAEyB,MAAM,EAAE,KAAK;IAAEf;EAAK,CAAC,EAAER,WAAW,CAAC;EAEzD0B,MAAM,EAAEA,CAAC5B,QAAQ,EAAEE,WAAW,GAAG,KAAK,KACpCH,OAAO,CAACC,QAAQ,EAAE;IAAEyB,MAAM,EAAE;EAAS,CAAC,EAAEvB,WAAW;AACvD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}