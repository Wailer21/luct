{"ast":null,"code":"import axios from \"axios\";\n\n// Base API URL (from frontend .env)\nconst API_BASE_URL = process.env.REACT_APP_API_URL ? `${process.env.REACT_APP_API_URL}/api` : \"http://localhost:5000/api\";\nexport const API_ENDPOINTS = {\n  // Auth\n  REGISTER: `${API_BASE_URL}/auth/register`,\n  LOGIN: `${API_BASE_URL}/auth/login`,\n  ME: `${API_BASE_URL}/auth/me`,\n  // Data\n  FACULTIES: `${API_BASE_URL}/faculties`,\n  COURSES: `${API_BASE_URL}/courses`,\n  CLASSES: `${API_BASE_URL}/classes`,\n  MY_CLASSES: `${API_BASE_URL}/my-classes`,\n  LECTURERS: `${API_BASE_URL}/lecturers`,\n  // Reports\n  REPORTS: `${API_BASE_URL}/reports`,\n  REPORTS_STATS: `${API_BASE_URL}/reports/stats`,\n  REPORTS_BY_ID: id => `${API_BASE_URL}/reports/${id}`,\n  REPORTS_FEEDBACK: id => `${API_BASE_URL}/reports/${id}/feedback`,\n  // Ratings - Add these missing endpoints\n  RATINGS: `${API_BASE_URL}/ratings`,\n  RATINGS_MY: `${API_BASE_URL}/ratings/my-ratings`,\n  RATINGS_LECTURER: `${API_BASE_URL}/ratings/lecturer`,\n  // Search\n  SEARCH: `${API_BASE_URL}/search`,\n  // Health\n  HEALTH: `${API_BASE_URL}/health`\n};\n\n// Get token from localStorage\nexport const getAuthToken = () => {\n  return localStorage.getItem(\"token\");\n};\n\n// Enhanced API call wrapper with error handling and automatic auth\nexport const apiCall = async (endpoint, options = {}, requireAuth = false) => {\n  try {\n    var _config$method;\n    const config = {\n      url: endpoint,\n      ...options,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...options.headers\n      }\n    };\n\n    // Add auth headers if required\n    if (requireAuth) {\n      const token = getAuthToken();\n      if (!token) {\n        throw new Error(\"Authentication required: No token found\");\n      }\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    console.log(`API Call: ${(_config$method = config.method) === null || _config$method === void 0 ? void 0 : _config$method.toUpperCase()} ${endpoint}`, config.data || '');\n    const response = await axios(config);\n\n    // Handle backend response format\n    if (response.data && response.data.success === false) {\n      throw new Error(response.data.message || \"Request failed\");\n    }\n    return response.data;\n  } catch (error) {\n    var _error$response, _error$response2, _error$response3;\n    console.error(\"API Call failed:\", ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message);\n\n    // Handle specific error cases\n    if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 401) {\n      // Clear invalid token\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"user\");\n      // Redirect to login\n      window.location.href = \"/login\";\n    }\n\n    // Return a consistent error format\n    const errorData = ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) || {\n      message: error.message\n    };\n    throw {\n      success: false,\n      message: errorData.message || \"API request failed\",\n      error: errorData\n    };\n  }\n};\n\n// Enhanced API methods with better error handling\nexport const api = {\n  get: async (endpoint, requireAuth = false) => {\n    try {\n      const response = await apiCall(endpoint, {\n        method: \"GET\"\n      }, requireAuth);\n      return {\n        success: true,\n        data: response.data || response,\n        message: response.message\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message,\n        error: error.error\n      };\n    }\n  },\n  post: async (endpoint, data, requireAuth = false) => {\n    try {\n      const response = await apiCall(endpoint, {\n        method: \"POST\",\n        data\n      }, requireAuth);\n      return {\n        success: true,\n        data: response.data || response,\n        message: response.message\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message,\n        error: error.error\n      };\n    }\n  },\n  put: async (endpoint, data, requireAuth = false) => {\n    try {\n      const response = await apiCall(endpoint, {\n        method: \"PUT\",\n        data\n      }, requireAuth);\n      return {\n        success: true,\n        data: response.data || response,\n        message: response.message\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message,\n        error: error.error\n      };\n    }\n  },\n  delete: async (endpoint, requireAuth = false) => {\n    try {\n      const response = await apiCall(endpoint, {\n        method: \"DELETE\"\n      }, requireAuth);\n      return {\n        success: true,\n        data: response.data || response,\n        message: response.message\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message,\n        error: error.error\n      };\n    }\n  }\n};","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","API_ENDPOINTS","REGISTER","LOGIN","ME","FACULTIES","COURSES","CLASSES","MY_CLASSES","LECTURERS","REPORTS","REPORTS_STATS","REPORTS_BY_ID","id","REPORTS_FEEDBACK","RATINGS","RATINGS_MY","RATINGS_LECTURER","SEARCH","HEALTH","getAuthToken","localStorage","getItem","apiCall","endpoint","options","requireAuth","_config$method","config","url","headers","token","Error","Authorization","console","log","method","toUpperCase","data","response","success","message","error","_error$response","_error$response2","_error$response3","status","removeItem","window","location","href","errorData","api","get","post","put","delete"],"sources":["C:/Users/Wailer/Downloads/luct_reporting_app_/luct_reporting_app/frontend/src/utils/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\n// Base API URL (from frontend .env)\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL\r\n  ? `${process.env.REACT_APP_API_URL}/api`\r\n  : \"http://localhost:5000/api\";\r\n\r\nexport const API_ENDPOINTS = {\r\n  // Auth\r\n  REGISTER: `${API_BASE_URL}/auth/register`,\r\n  LOGIN: `${API_BASE_URL}/auth/login`,\r\n  ME: `${API_BASE_URL}/auth/me`,\r\n\r\n  // Data\r\n  FACULTIES: `${API_BASE_URL}/faculties`,\r\n  COURSES: `${API_BASE_URL}/courses`,\r\n  CLASSES: `${API_BASE_URL}/classes`,\r\n  MY_CLASSES: `${API_BASE_URL}/my-classes`,\r\n  LECTURERS: `${API_BASE_URL}/lecturers`,\r\n\r\n  // Reports\r\n  REPORTS: `${API_BASE_URL}/reports`,\r\n  REPORTS_STATS: `${API_BASE_URL}/reports/stats`,\r\n  REPORTS_BY_ID: (id) => `${API_BASE_URL}/reports/${id}`,\r\n  REPORTS_FEEDBACK: (id) => `${API_BASE_URL}/reports/${id}/feedback`,\r\n\r\n  // Ratings - Add these missing endpoints\r\n  RATINGS: `${API_BASE_URL}/ratings`,\r\n  RATINGS_MY: `${API_BASE_URL}/ratings/my-ratings`,\r\n  RATINGS_LECTURER: `${API_BASE_URL}/ratings/lecturer`,\r\n\r\n  // Search\r\n  SEARCH: `${API_BASE_URL}/search`,\r\n\r\n  // Health\r\n  HEALTH: `${API_BASE_URL}/health`,\r\n};\r\n\r\n// Get token from localStorage\r\nexport const getAuthToken = () => {\r\n  return localStorage.getItem(\"token\");\r\n};\r\n\r\n// Enhanced API call wrapper with error handling and automatic auth\r\nexport const apiCall = async (endpoint, options = {}, requireAuth = false) => {\r\n  try {\r\n    const config = {\r\n      url: endpoint,\r\n      ...options,\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers,\r\n      },\r\n    };\r\n\r\n    // Add auth headers if required\r\n    if (requireAuth) {\r\n      const token = getAuthToken();\r\n      if (!token) {\r\n        throw new Error(\"Authentication required: No token found\");\r\n      }\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n\r\n    console.log(`API Call: ${config.method?.toUpperCase()} ${endpoint}`, config.data || '');\r\n\r\n    const response = await axios(config);\r\n    \r\n    // Handle backend response format\r\n    if (response.data && response.data.success === false) {\r\n      throw new Error(response.data.message || \"Request failed\");\r\n    }\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"API Call failed:\", error.response?.data || error.message);\r\n    \r\n    // Handle specific error cases\r\n    if (error.response?.status === 401) {\r\n      // Clear invalid token\r\n      localStorage.removeItem(\"token\");\r\n      localStorage.removeItem(\"user\");\r\n      // Redirect to login\r\n      window.location.href = \"/login\";\r\n    }\r\n    \r\n    // Return a consistent error format\r\n    const errorData = error.response?.data || { message: error.message };\r\n    throw {\r\n      success: false,\r\n      message: errorData.message || \"API request failed\",\r\n      error: errorData\r\n    };\r\n  }\r\n};\r\n\r\n// Enhanced API methods with better error handling\r\nexport const api = {\r\n  get: async (endpoint, requireAuth = false) => {\r\n    try {\r\n      const response = await apiCall(endpoint, { method: \"GET\" }, requireAuth);\r\n      return {\r\n        success: true,\r\n        data: response.data || response,\r\n        message: response.message\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        message: error.message,\r\n        error: error.error\r\n      };\r\n    }\r\n  },\r\n  \r\n  post: async (endpoint, data, requireAuth = false) => {\r\n    try {\r\n      const response = await apiCall(endpoint, { method: \"POST\", data }, requireAuth);\r\n      return {\r\n        success: true,\r\n        data: response.data || response,\r\n        message: response.message\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        message: error.message,\r\n        error: error.error\r\n      };\r\n    }\r\n  },\r\n  \r\n  put: async (endpoint, data, requireAuth = false) => {\r\n    try {\r\n      const response = await apiCall(endpoint, { method: \"PUT\", data }, requireAuth);\r\n      return {\r\n        success: true,\r\n        data: response.data || response,\r\n        message: response.message\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        message: error.message,\r\n        error: error.error\r\n      };\r\n    }\r\n  },\r\n  \r\n  delete: async (endpoint, requireAuth = false) => {\r\n    try {\r\n      const response = await apiCall(endpoint, { method: \"DELETE\" }, requireAuth);\r\n      return {\r\n        success: true,\r\n        data: response.data || response,\r\n        message: response.message\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        message: error.message,\r\n        error: error.error\r\n      };\r\n    }\r\n  },\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}